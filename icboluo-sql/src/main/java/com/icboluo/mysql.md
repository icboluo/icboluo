## idea链接mysql

1.通过联网下载驱动

2.找到本地mysql的jar包，配置驱动就可以了

mysql union 作用就是拼接上面查询出的结果和下面查询出的结果， 查询结果不变，数据量增加

ctrl shift r 全局搜索 可以搜索数据库中的表的使用

## explain

mysql对于查询语句用explain进行优化

## 索引失效

当作为状态值的时候，如果该值的出现的比率较高，则索引失效

    首先进入该值的节点，然后进入下一个节点，这是用索引
    进入下一个节点（虽然节点数多，但是只走树的一个分支，很可能比较快），这是用全局扫描

索引要求离散度较高，才有区分度，没有使用索引是因为mysql优化认为不用索引效率更高

group by 和order by的时候，很容易造成效率低下，可以对count语句进行优化

- 联合索引的效率和普通索引的效率一致
- 联合索引（a，b，c）相当于创建了a、ab、abc索引，最左匹配，对于b相当于没有创建索引，所以，创建联合索引的时候 需要仔细点

uuid类型的主键，使用的时候用索引；自增类型的主键，使用的时候不用使用索引

mysql全表扫描对应explain中的all，是对数据进行一行一行的扫描

避免数据类型转换，会使索引失效

## left join

- left join and 中的and是先进行右表筛选，再进行总数据匹配，如果筛选结果为空，则left join的整个右表数据为空
- 业务中常进行整个数据筛选，用where比left join合适
- mysql 左模糊 like 语句可以使用 locate（相当于 substring ）等语句替代

## or

> or链接的时候，只有全部加索引索引才会生效，不建议用or；修改方式：

- 同字段用in代替
- 不同字段用union拼接

## 特殊sql

SELECT COALESCE(business_name,'no business_name') AS bus_coalesce FROM business WHERE id=1

查询，如果第一个结果为空，用第二个参数，如果第二个为空用下一个...

分组中可以使用，先求和，再求总和

使用场景：暂无，分组求和再代码中写更简单

## 建表

表字段用业务+字段属性...不要只用单纯的字段属性，不要觉得字段过长，这样，使用过程比较清晰

## 最佳实践

- 对公共sql的更改需要在mapper接口上增加注释，更改公共sql的时候，需要merge，不准直接copy覆盖

## 索引

必定出现的left join 中需要加上索引，不一定出现的不需要加，where条件同理

普通查询会用到覆盖索引，只要查询的字段都有索引就不会回表

子查询无法使用索引

hash算法无法范围查找，一般不用做mysql索引

缺点：

索引太多会增加执行计划生成时间，也会增加修改时间

## 主键

mysql无序主键会导致页分裂，页分裂会导致碎片数据

自增主键用光就不动了，会报主键重复异常

如果不指定主键，会有一个默认的row id作为主键，主键用光后更新操作会覆盖原有数据

### mysql自增主键重置：

删除数据：delete from crew_test

删除主键数据：truncate table crew_test

## select 语句

select * 语句：

io问题：增大网络开销 扩展性：增减字段难以控制（但是可以动态返回全部字段，有利有弊

阅读问题：读起来更加简洁（指定字段读起来更加流水账

索引问题：覆盖索引更可能出现（这个基本用不到吧

## 字段映射

tinyint == byte
